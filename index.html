<!doctype html>
<html lang="de">
<head>
  <!-- =====================================================================
       fnothing · Signals — High-Performance Static Site (GitHub Pages ready)
       ===================================================================== -->

  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <title>fnothing Signals – Krypto- & Aktien-Signale</title>
  <meta name="description" content="fnothing Signals liefert strukturierte Handels-Signale für Krypto, Aktien & mehr – schnell, klar, professionell. Später mit Subscription & Paywall.">
  <meta name="theme-color" content="#0b0b0c">

  <!-- Canonical & no-www enforcement (OneSignal erlaubt nur https://fnothing.com) -->
  <link rel="canonical" href="https://fnothing.com/">
  <script>
    if (location.hostname.startsWith('www.')) {
      location.replace(location.href.replace('//www.', '//'));
    }
  </script>

  <!-- Open Graph / Twitter -->
  <meta property="og:type" content="website">
  <meta property="og:title" content="fnothing Signals – Krypto- & Aktien-Signale">
  <meta property="og:description" content="Strukturierte Signale, klare Setups, später als Subscription hinter Paywall.">
  <meta property="og:url" content="https://fnothing.com/">
  <meta property="og:image" content="https://fnothing.com/og-image.png">
  <meta name="twitter:card" content="summary_large_image">

  <!-- PWA / iOS -->
  <link rel="manifest" href="/manifest.json" />
  <link rel="apple-touch-icon" href="/icon-192.png">
  <meta name="apple-mobile-web-app-capable" content="yes">
  <meta name="apple-mobile-web-app-status-bar-style" content="default">

  <!-- Performance hints -->
  <link rel="preconnect" href="https://cdn.onesignal.com" crossorigin>
  <link rel="dns-prefetch" href="https://cdn.onesignal.com">

  <!-- Favicon (SVG) -->
  <link rel="icon" type="image/svg+xml"
        href="data:image/svg+xml,%3Csvg xmlns='http://www.w3.org/2000/svg' viewBox='0 0 48 48'%3E%3Cdefs%3E%3ClinearGradient id='g' x1='0' y1='0' x2='1' y2='1'%3E%3Cstop offset='0' stop-color='%237c5cff'/%3E%3Cstop offset='1' stop-color='%235a3dff'/%3E%3C/linearGradient%3E%3C/defs%3E%3Crect rx='12' width='48' height='48' fill='url(%23g)'/%3E%3Cpath d='M13 30h11M24 30l11-14M13 23h8' stroke='%23fff' stroke-linecap='round' stroke-width='3'/%3E%3C/svg%3E">

  <style>
    /* --------------------------- Design Tokens --------------------------- */
    :root{
      --bg:#0b0b0c; --panel:#111114; --elev:#16161a; --text:#f4f4f5; --muted:#c4c4c7;
      --line:#27272a; --brand:#7c5cff; --brand2:#00e0a4; --danger:#ff7a7a; --ok:#17c964;
      --radius:16px; --shadow:0 10px 30px rgba(0,0,0,.35); --w:min(1180px,92vw);
    }
    @media (prefers-color-scheme: light){
      :root{ --bg:#fff; --panel:#f6f7f9; --elev:#fff; --text:#111114; --muted:#444; --line:#e5e7eb; }
    }

    /* ------------------------------ Base -------------------------------- */
    *,*::before,*::after{ box-sizing:border-box }
    html,body{ height:100% }
    body{
      margin:0; color:var(--text);
      font: 16px/1.6 system-ui,-apple-system,"Segoe UI",Roboto,Ubuntu,Cantarell,"Helvetica Neue",Arial,sans-serif;
      background:
        radial-gradient(1200px 600px at 70% -10%, rgba(124,92,255,.16), transparent 60%),
        radial-gradient(800px 400px at 10% -10%, rgba(0,224,164,.10), transparent 50%),
        var(--bg);
    }
    a{ color:inherit; text-decoration:none }
    img{ max-width:100%; display:block }
    .container{ width:var(--w); margin-inline:auto }
    .visually-hidden{ position:absolute; width:1px; height:1px; margin:-1px; padding:0; overflow:hidden; clip:rect(0 0 0 0); white-space:nowrap; border:0 }

    /* ---------------------------- Utilities ----------------------------- */
    .stack{ display:grid; gap:1rem }
    .stack-lg{ display:grid; gap:2rem }
    .grid{ display:grid; gap:1rem }
    .grid-3{ grid-template-columns:repeat(3, minmax(0,1fr)) }
    @media (max-width: 960px){ .grid-3{ grid-template-columns:1fr } }
    .card{
      background:linear-gradient(180deg, var(--elev), var(--panel));
      border:1px solid var(--line); border-radius:var(--radius);
      padding:1.25rem; box-shadow:var(--shadow)
    }
    .surface{ background:linear-gradient(180deg, var(--elev), var(--panel)); border:1px solid var(--line) }
    .kicker{ letter-spacing:.12em; text-transform:uppercase; font-size:.78rem; color:var(--muted) }
    .h1{ font-size:clamp(2rem, 5vw, 3.25rem); line-height:1.1; margin:.2rem 0 .6rem }
    .h2{ font-size:clamp(1.4rem, 2.6vw, 2rem); margin:0 0 .5rem }
    .muted{ color:var(--muted) }
    .badge{ display:inline-flex; align-items:center; gap:.5rem; font-size:.85rem; padding:.4rem .7rem; border:1px solid var(--line); border-radius:999px; background:rgba(124,92,255,.10) }

    /* ---------------------------- Components ---------------------------- */
    header{
      position:sticky; top:0; z-index:50;
      backdrop-filter:saturate(140%) blur(6px);
      background:color-mix(in oklab, var(--bg) 86%, transparent);
      border-bottom:1px solid var(--line)
    }
    .nav{ display:flex; align-items:center; justify-content:space-between; gap:1rem; padding:.8rem 0 }
    .brand{ display:flex; align-items:center; gap:.8rem; font-weight:800 }
    .logo{ width:36px; height:36px }
    .navlinks{ display:flex; align-items:center; gap:.6rem; flex-wrap:wrap }
    .navlinks a{ padding:.5rem .7rem; border-radius:10px }
    .navlinks a:is(:hover,:focus-visible){ background:rgba(124,92,255,.12) }

    .btn{
      display:inline-flex; align-items:center; justify-content:center; gap:.6rem;
      padding:.85rem 1.1rem; border-radius:12px; border:1px solid var(--line);
      cursor:pointer; font-weight:700; transition:transform .12s ease, background .12s ease, border-color .12s ease;
      will-change:transform
    }
    .btn:is(:hover,:focus-visible){ transform:translateY(-1px) }
    .btn-primary{ background:linear-gradient(180deg, var(--brand), #5a3dff); color:#fff; border-color:transparent }
    .btn-outline{ background:transparent; border-color:var(--brand); color:var(--brand) }
    .btn-ghost{ background:transparent }

    .hero{ padding:3.8rem 0 2.6rem; position:relative }
    .hero-art{
      position:absolute; inset:auto -10% -25% auto; width:min(900px,90vw); height:420px; pointer-events:none; opacity:.35; filter:blur(10px);
      background:
        radial-gradient(220px 160px at 30% 35%, rgba(124,92,255,.35), transparent 60%),
        radial-gradient(260px 180px at 60% 40%, rgba(0,224,164,.20), transparent 60%),
        conic-gradient(from 30deg at 60% 30%, rgba(90,61,255,.18), transparent 60%);
      transform:rotate(-6deg)
    }

    .stats{ display:grid; grid-template-columns:repeat(4,1fr); gap:1rem }
    @media (max-width:1000px){ .stats{ grid-template-columns:repeat(2,1fr) } }
    @media (max-width:640px){ .stats{ grid-template-columns:1fr } }
    .stat{ padding:1.1rem; border:1px dashed var(--line); border-radius:14px; background:linear-gradient(180deg, transparent, rgba(124,92,255,.06)) }
    .stat b{ font-size:1.3rem }

    .pricing{ display:grid; grid-template-columns:repeat(3,1fr); gap:1rem }
    @media (max-width:1000px){ .pricing{ grid-template-columns:1fr } }
    .tier{ padding:1.3rem; border:1px solid var(--line); border-radius:16px; background:linear-gradient(180deg, var(--elev), var(--panel)); position:relative }
    .tier.popular{ outline:2px solid var(--brand) }
    .price{ font-size:2.2rem; font-weight:800; margin:.2rem 0 }
    .toggle{ display:inline-flex; gap:.4rem; align-items:center; padding:.3rem; border-radius:999px; border:1px solid var(--line) }
    .toggle button{ border:0; background:transparent; padding:.5rem .8rem; border-radius:999px; cursor:pointer; color:var(--muted) }
    .toggle button.active{ background:rgba(124,92,255,.16); color:var(--text) }

    footer{ border-top:1px solid var(--line); margin-top:3rem }
    .foot{ display:flex; flex-wrap:wrap; align-items:center; justify-content:space-between; gap:1rem; padding:1.4rem 0 }
    .legal{ font-size:.9rem; color:var(--muted) }

    /* Focus & motion */
    :focus-visible{ outline:2px solid var(--brand); outline-offset:2px; border-radius:8px }
    @media (prefers-reduced-motion: reduce){ *{ animation:none !important; transition:none !important } }
    section{ padding:2.2rem 0 }
  </style>
</head>
<body>
  <a class="visually-hidden" href="#content">Zum Inhalt springen</a>

  <!-- ============================== Header ============================== -->
  <header>
    <div class="container nav">
      <a class="brand" href="/" aria-label="Startseite">
        <!-- Minimalist Pro Logo (inline SVG) -->
        <svg class="logo" viewBox="0 0 48 48" aria-hidden="true">
          <defs>
            <linearGradient id="lg" x1="0" y1="0" x2="1" y2="1">
              <stop offset="0" stop-color="#7c5cff"/>
              <stop offset="1" stop-color="#5a3dff"/>
            </linearGradient>
          </defs>
          <rect rx="12" width="48" height="48" fill="url(#lg)"/>
          <path d="M13 30h11M24 30l11-14M13 23h8" stroke="#fff" stroke-linecap="round" stroke-width="3"/>
        </svg>
        <span>fnothing <span class="muted">Signals</span></span>
      </a>

      <nav class="navlinks" aria-label="Hauptnavigation">
        <a href="#vorteile">Vorteile</a>
        <a href="#maerkte">Märkte</a>
        <a href="#preise">Preise</a>
        <a href="#faq">FAQ</a>
        <a class="btn btn-outline" href="#waitlist">Zugang anfragen</a>
      </nav>
    </div>
  </header>

  <!-- =============================== Main =============================== -->
  <main id="content">
    <!-- ============================== Hero ============================== -->
    <section class="hero">
      <div class="hero-art" aria-hidden="true"></div>
      <div class="container stack-lg">
        <div class="stack">
          <span class="badge"><span aria-hidden="true">⚡</span> Reaktionsschnell • Klar • Erweiterbar</span>
          <h1 class="h1">Signale für Krypto, Aktien & mehr – klar strukturiert, bereit für deinen Edge.</h1>
          <p class="muted" style="max-width:70ch">
            fnothing Signals liefert saubere Setups mit Entry-, SL- und TP-Zonen, damit du schneller entscheiden kannst.
            Heute als robuste Basis für deinen Bot – später als Subscription hinter Paywall.
          </p>
          <div class="cta" style="display:flex; gap:.8rem; flex-wrap:wrap; margin-top:1.2rem">
            <a class="btn btn-primary" href="#waitlist">Zugang sichern</a>
            <a class="btn btn-ghost" href="#preise">Preise ansehen</a>

            <!-- Push: Button + Status -->
            <button class="btn btn-outline" id="push-btn" type="button">🔔 Push aktivieren</button>
            <span id="push-state" class="muted" style="align-self:center"></span>
          </div>
        </div>

        <div class="stats" aria-label="Kennzahlen">
          <div class="stat"><b>24/7</b><br><span class="muted">Monitoring</span></div>
          <div class="stat"><b>&lt; 1s</b><br><span class="muted">Client-Side Render-Latenz</span></div>
          <div class="stat"><b>Multi-Asset</b><br><span class="muted">Krypto • Aktien • FX (optional)</span></div>
          <div class="stat"><b>API-Ready</b><br><span class="muted">Webhooks & Integrationen</span></div>
        </div>
      </div>
    </section>

    <!-- ============================ Vorteile ============================ -->
    <section id="vorteile">
      <div class="container stack-lg">
        <p class="kicker">Warum fnothing</p>
        <h2 class="h2">Signalqualität & Klarheit, die skaliert</h2>

        <div class="grid grid-3">
          <article class="card">
            <div class="stack">
              <div class="badge" aria-hidden="true">①</div>
              <h3 class="h3">Klares Setup-Format</h3>
              <p class="muted">Einheitliche Struktur mit Entry, Stop, Targets & Zeitrahmen – ideal für manuelle wie automatisierte Ausführung.</p>
            </div>
          </article>
          <article class="card">
            <div class="stack">
              <div class="badge" aria-hidden="true">②</div>
              <h3 class="h3">Signal-Kanäle nach Wahl</h3>
              <p class="muted">Webhook/API, E-Mail, Telegram oder Dashboard – du entscheidest, wo die Signale landen.</p>
            </div>
          </article>
          <article class="card">
            <div class="stack">
              <div class="badge" aria-hidden="true">③</div>
              <h3 class="h3">Risikoparameter</h3>
              <p class="muted">Platzhalter für deine spätere Risikosteuerung (PosGröße, R-Multiplikator, Max-DD) – UI ist vorbereitet.</p>
            </div>
          </article>
        </div>

        <div class="card">
          <strong>Integrations-Hook (Platzhalter)</strong>
          <p class="muted">Hier fügst du später deinen Bot ein (Script-Snippet / SDK / Widget). Die Karte hat bewusst eine neutrale Oberfläche, damit du nur die Einbindung austauschen musst.</p>
          <!-- === BOT-INTEGRATION START ===
          <script src="DEIN-BOT-SNIPPET.js"></script>
          <div id="dein-bot-widget"></div>
          === BOT-INTEGRATION ENDE === -->
        </div>
      </div>
    </section>

    <!-- ============================ Märkte ============================== -->
    <section id="maerkte">
      <div class="container stack-lg">
        <p class="kicker">Abdeckung</p>
        <h2 class="h2">Multi-Asset ohne Ballast</h2>
        <div class="grid grid-3">
          <div class="card">
            <h3>Krypto</h3>
            <p class="muted">BTC, ETH, Large Caps sowie ausgewählte Perpetuals. Signale mit klaren Risiko-/Ertrags-Zonen.</p>
          </div>
          <div class="card">
            <h3>Aktien</h3>
            <p class="muted">US & EU Blue Chips, Momentum-Listen; Timeframes von Intraday bis Swing.</p>
          </div>
          <div class="card">
            <h3>Mehr</h3>
            <p class="muted">Erweiterbar auf FX, Indizes, Rohstoffe – UI & Routing sind vorbereitet.</p>
          </div>
        </div>
      </div>
    </section>

    <!-- ============================ Pricing ============================= -->
    <section id="preise">
      <div class="container stack-lg">
        <div style="display:flex; align-items:center; justify-content:space-between; gap:1rem; flex-wrap:wrap;">
          <div>
            <p class="kicker">Preise</p>
            <h2 class="h2">Einfaches, skalierbares Pricing</h2>
            <p class="muted">Abrechnung monatlich oder jährlich (−2 Monate gratis). Später per Paywall aktiv.</p>
          </div>
          <div class="toggle" role="tablist" aria-label="Abrechnungszeitraum">
            <button id="t-monthly" class="active" aria-selected="true" aria-controls="price-panels">Monatlich</button>
            <button id="t-yearly" aria-selected="false" aria-controls="price-panels">Jährlich</button>
          </div>
        </div>

        <div id="price-panels" class="pricing" aria-live="polite">
          <div class="tier">
            <span class="kicker">Starter</span>
            <div class="price" data-price data-monthly="€19" data-yearly="€190">€19</div>
            <p class="muted">Für den Einstieg & Paper-Trading.</p>
            <ul>
              <li>Basis-Signale (verzögert)</li>
              <li>Dashboard-Zugang</li>
              <li>E-Mail-Routing</li>
            </ul>
            <a class="btn btn-primary" href="#waitlist">Bald verfügbar</a>
          </div>

          <div class="tier popular">
            <span class="kicker">Pro</span>
            <div class="price" data-price data-monthly="€49" data-yearly="€490">€49</div>
            <p class="muted">Live-Signale & erweiterte Kanäle.</p>
            <ul>
              <li>Live-Signale (niedrige Latenz)</li>
              <li>Telegram/Webhook/API</li>
              <li>Risikoparameter-Presets</li>
            </ul>
            <a class="btn btn-primary" href="#waitlist">Bald verfügbar</a>
          </div>

          <div class="tier">
            <span class="kicker">Institutional</span>
            <div class="price" data-price data-monthly="Custom" data-yearly="Custom">Custom</div>
            <p class="muted">Maßgeschneiderte Feeds & SLOs.</p>
            <ul>
              <li>Dedizierte Feeds</li>
              <li>Priorisierter Support</li>
              <li>On-Prem/Virtual Private Routing</li>
            </ul>
            <a class="btn btn-ghost" href="#kontakt">Anfrage senden</a>
          </div>
        </div>
      </div>
    </section>

    <!-- ============================ Waitlist ============================ -->
    <section id="waitlist">
      <div class="container stack-lg">
        <p class="kicker">Früher Zugang</p>
        <h2 class="h2">Trag dich ein – wir melden uns zum Launch</h2>
        <div class="card">
          <form class="stack" method="post" action="#" onsubmit="event.preventDefault(); alert('Danke! Wir melden uns per E-Mail.');">
            <label for="email">E-Mail</label>
            <input id="email" name="email" type="email" required
              placeholder="dein@email.de"
              style="padding:.9rem 1rem; border-radius:12px; border:1px solid var(--line); background:var(--elev); color:var(--text); width:100%;">
            <small class="muted">Wir schicken nur Relevantes zum Produktstart. Kein Spam.</small>
            <div><button class="btn btn-primary" type="submit">Auf die Liste</button></div>
          </form>
        </div>
      </div>
    </section>

    <!-- ============================== FAQ =============================== -->
    <section id="faq">
      <div class="container stack-lg">
        <p class="kicker">FAQ</p>
        <h2 class="h2">Häufige Fragen</h2>
        <div class="grid">
          <details class="card">
            <summary><strong>Ist das Anlageberatung?</strong></summary>
            <p class="muted">Nein. Die bereitgestellten Informationen sind <strong>keine</strong> Anlageberatung und keine Empfehlung zum Kauf/Verkauf von Finanzinstrumenten. Du handelst eigenverantwortlich.</p>
          </details>
          <details class="card">
            <summary><strong>Welche Latenz haben die Signale?</strong></summary>
            <p class="muted">Die UI rendert client-seitig sehr schnell. Die effektive Latenz hängt von deinem Routing (z. B. Telegram, Webhook) und Drittanbietern ab.</p>
          </details>
          <details class="card">
            <summary><strong>Welche Märkte sind enthalten?</strong></summary>
            <p class="muted">Standardmäßig Krypto & Aktien. Erweiterungen (FX, Indizes) sind vorgesehen und können aktiv geschaltet werden.</p>
          </details>
          <details class="card">
            <summary><strong>Kann ich meinen eigenen Bot integrieren?</strong></summary>
            <p class="muted">Ja. In der Sektion „Integrations-Hook“ findest du den Platzhalter für dein Script/Widget.</p>
          </details>
        </div>
      </div>
    </section>

    <!-- =========================== Disclaimer =========================== -->
    <section aria-label="Rechtlicher Hinweis">
      <div class="container card">
        <p class="muted">
          <strong>Wichtiger Hinweis:</strong> Handel mit Kryptowährungen, Aktien, Derivaten und anderen Finanzinstrumenten ist mit erheblichen Risiken verbunden.
          Frühere Ergebnisse sind kein Indikator für zukünftige Entwicklungen. Dies ist keine Finanzberatung.
        </p>
      </div>
    </section>
  </main>

  <!-- ============================== Footer ============================== -->
  <footer>
    <div class="container foot">
      <div class="brand" style="gap:.6rem">
        <svg class="logo" viewBox="0 0 48 48" aria-hidden="true">
          <defs><linearGradient id="lg2" x1="0" y1="0" x2="1" y2="1">
            <stop offset="0" stop-color="#7c5cff"/><stop offset="1" stop-color="#5a3dff"/></linearGradient></defs>
          <rect rx="12" width="48" height="48" fill="url(#lg2)"/>
          <path d="M13 30h11M24 30l11-14M13 23h8" stroke="#fff" stroke-linecap="round" stroke-width="3"/>
        </svg>
        <span>fnothing <span class="muted">Signals</span></span>
      </div>
      <div class="legal">© <span id="year"></span> fnothing. Alle Rechte vorbehalten. · <a class="muted" href="#impressum">Impressum</a> · <a class="muted" href="#agb">AGB</a> · <a class="muted" href="#datenschutz">Datenschutz</a></div>
    </div>
  </footer>

  <noscript><div class="container" style="margin:1rem 0"><div class="card">Bitte aktiviere JavaScript, um alle Funktionen zu nutzen.</div></div></noscript>

  <!-- ========================== Page Scripts ============================ -->
  <script>
    // Jahr im Footer
    document.getElementById('year').textContent = new Date().getFullYear();

    // Pricing Toggle (Monatlich / Jährlich)
    const tMonthly = document.getElementById('t-monthly');
    const tYearly  = document.getElementById('t-yearly');
    const prices   = document.querySelectorAll('[data-price]');
    function setBilling(mode){
      prices.forEach(el => el.textContent = el.dataset[mode]);
      tMonthly.classList.toggle('active', mode === 'monthly');
      tYearly.classList.toggle('active',  mode === 'yearly');
      tMonthly.setAttribute('aria-selected', mode === 'monthly');
      tYearly.setAttribute('aria-selected',  mode === 'yearly');
    }
    tMonthly?.addEventListener('click', () => setBilling('monthly'));
    tYearly?.addEventListener('click',  () => setBilling('yearly'));
  </script>

  <!-- JSON-LD (Organisation) -->
  <script type="application/ld+json">
  {
    "@context": "https://schema.org",
    "@type": "Organization",
    "name": "fnothing Signals",
    "url": "https://fnothing.com",
    "logo": "https://fnothing.com/favicon.svg"
  }
  </script>

  <!-- ====================== OneSignal Web Push v16 ====================== -->
  <script src="https://cdn.onesignal.com/sdks/web/v16/OneSignalSDK.page.js" defer></script>
  <script>
    // iOS: Hinweis, wenn nicht als PWA (Standalone) geöffnet
    (function(){
      const isIOS = /iphone|ipad|ipod/i.test(navigator.userAgent);
      const standalone = navigator.standalone === true || matchMedia('(display-mode: standalone)').matches;
      if (isIOS && !standalone) {
        const box = document.createElement('div');
        box.style.cssText = "position:fixed;top:12px;left:12px;right:12px;background:#fff;color:#111;padding:12px;border:1px solid #e5e7eb;border-radius:12px;z-index:9999;box-shadow:0 10px 30px rgba(0,0,0,.15)";
        box.innerHTML = "<b>iPhone: Push aktivieren</b><br>In <u>Safari</u> öffnen → <em>Teilen</em> → <em>Zum Home-Bildschirm</em>. Danach die App vom Homescreen starten.";
        document.body.appendChild(box);
        setTimeout(()=>box.remove(), 8000);
      }
    })();

    // Hauptintegration
    window.OneSignalDeferred = window.OneSignalDeferred || [];
    window.OneSignalDeferred.push(async function(OneSignal) {
      try {
        await OneSignal.init({
          appId: "9fe27bc6-4db2-4381-83ed-21e9fec4fec0",
          serviceWorkerPath: "/OneSignalSDKWorker.js",
          serviceWorkerUpdaterPath: "/OneSignalSDKUpdaterWorker.js",
          serviceWorkerParam: { scope: "/" },
          notifyButton: { enable: true }
        });

        const btn   = document.getElementById("push-btn");
        const state = document.getElementById("push-state");

        async function updateState(){
          const supported = await OneSignal.Notifications.isPushSupported();
          const perm      = await OneSignal.Notifications.permission; // "default" | "granted" | "denied"
          const subId     = await OneSignal.User.pushSubscriptionId;
          state.textContent = `Support: ${supported} · Permission: ${perm} · ID: ${subId || "–"}`;
          if (btn) btn.disabled = (perm === 'denied' || !supported);
        }

        btn?.addEventListener("click", async () => {
          try {
            const supported = await OneSignal.Notifications.isPushSupported();
            if (!supported) {
              alert("Push wird hier nicht unterstützt (z. B. iOS-Browser-Tab). Öffne die PWA vom Homescreen.");
              return;
            }
            if (OneSignal.Slidedown?.promptPush) await OneSignal.Slidedown.promptPush();
            else await OneSignal.Notifications.requestPermission();
            await OneSignal.User.addTag("signals","true");
          } catch (e) {
            console.warn("subscribe error", e);
            alert("Konnte nicht abonnieren. Siehe Konsole.");
          } finally {
            await updateState();
          }
        });

        // Initiale Diagnose
        await updateState();

      } catch (e) {
        console.warn("OneSignal init error", e);
      }
    });
  </script>

  <!-- =============== Kompaktes Debug-Panel (optional) ================== -->
  <details class="container" style="margin:1rem 0">
    <summary class="muted">Diagnose öffnen (Push/Web)</summary>
    <div class="card" id="diag">Lade…</div>
    <div class="stack" style="margin-top:.8rem; display:flex; gap:.6rem; flex-wrap:wrap">
      <button class="btn" id="diag-refresh">Status aktualisieren</button>
      <button class="btn" id="diag-reset">SW/Cache zurücksetzen</button>
    </div>
  </details>
  <script>
    (function(){
      const $ = s => document.querySelector(s);
      const box = $("#diag");
      const refresh = async (label="status")=>{
        try{
          const isStandalone = navigator.standalone === true || matchMedia('(display-mode: standalone)').matches;
          const hasSW = 'serviceWorker' in navigator;
          const hasPushMgr = 'PushManager' in window;
          const perm = window.Notification ? Notification.permission : "n/a";
          const OneSignal = window.OneSignal || window.OneSignalDeferred;
          let osPerm="n/a", subId=null, supported=null;
          try {
            osPerm = await window.OneSignal.Notifications.permission;
            subId  = await window.OneSignal.User.pushSubscriptionId;
            supported = await window.OneSignal.Notifications.isPushSupported();
          } catch(_) {}
          const regs = hasSW ? (await navigator.serviceWorker.getRegistrations()).map(r=>r.scope) : [];
          box.textContent =
            `${label}\n`+
            `display: ${isStandalone?'standalone':'browser'} · SW:${hasSW} · PushMgr:${hasPushMgr} · Notification.permission:${perm}\n`+
            `OneSignal: supported:${supported} · perm:${osPerm} · subId:${subId||'–'}\n`+
            `SW scopes: ${regs.join(', ')||'–'}`;
        }catch(e){ box.textContent = "Diag-Error: "+(e.message||e); }
      };
      $("#diag-refresh")?.addEventListener('click',()=>refresh('manual'));
      $("#diag-reset")?.addEventListener('click', async ()=>{
        try{
          const regs = await navigator.serviceWorker.getRegistrations();
          for(const r of regs) await r.unregister();
          if (window.caches){ const ks = await caches.keys(); for (const k of ks) await caches.delete(k); }
          localStorage.clear(); sessionStorage.clear();
          alert("Zurückgesetzt. Seite neu laden & erneut testen.");
        }catch(e){ alert(e.message) }
        refresh('after reset');
      });
      refresh('init');
    })();
  </script>
</body>
</html>
